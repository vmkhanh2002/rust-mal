rule MalwareSyscalls: high {
    meta:
        description = "Detect malware-related system calls and files dropped in suspicious directories with executable extensions"
        severity = "HIGH"
        category = "System Calls"
        author = "PackageGuard Team"
        date = "2025"
    strings:
        $dropped_malware = /(\/tmp\/|\/var\/|\/dev\/|\/run\/)[^\s]+(\.exe|\.sh|\.bin|\.py|\.pl|\.php|\.js|\.jar|\.elf)?/
        $malware_syscall = /(system|execve|popen|CreateProcess|ShellExecute|LoadLibrary|dlopen)/
    condition:
        $dropped_malware or $malware_syscall
} 