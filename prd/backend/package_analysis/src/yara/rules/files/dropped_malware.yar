rule DroppedMalwareFile: high {
    meta:
        description = "Detect files dropped in suspicious locations with malicious extensions or suspicious names indicating malware, backdoors, or trojans"
        severity = "HIGH"
        category = "File Operations"
        author = "PackageGuard Team"
        date = "2025"
    strings:
        $tmp_dir = /(\/tmp\/|\/var\/|\/dev\/|\/run\/)/
        $mal_ext = /(\.exe|\.sh|\.bin|\.py|\.pl|\.php|\.js|\.jar|\.elf)$/
        $suspicious_name = /(update|patch|install|payload|backdoor|shell|rootkit|virus|trojan|malware)/i
        $archive_ext = /(\.zip|\.tar|\.gz|\.bz2|\.xz|\.7z|\.rar)$/
        
    condition:
        ($tmp_dir and $mal_ext) or $suspicious_name or ($tmp_dir and $archive_ext)
} 